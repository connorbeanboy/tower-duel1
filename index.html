<!doctype html><html><head><meta charset="utf-8"><title>Tower Duel</title><style>
body{margin:0;background:#111;color:#eee;font-family:Arial,sans-serif}
#gameContainer{width:960px;margin:16px auto}.ui{text-align:center;margin-bottom:8px}
.cards{display:flex;justify-content:center;gap:8px}.card{background:#222;padding:6px 10px;border-radius:6px;cursor:pointer;user-select:none}
.card.locked{opacity:.5;cursor:not-allowed}
</style><script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script></head><body>
<div id="gameContainer"><div class="ui"><div>Elixir:<span id="elixir">0</span>/10</div>
<div class="cards"><div class="card" id="card-1">Slinger(3)</div><div class="card" id="card-2">Giantling(5)</div><div class="card" id="card-3">Bolt(2)</div></div></div><div id="phaser-game"></div></div>
<script>
const W=960,H=540,Y=[160,380],cfg={type:Phaser.AUTO,width:W,height:H,parent:'phaser-game',backgroundColor:0x16324a,physics:{default:'arcade'},scene:{create,update}};
new Phaser.Game(cfg);let e=5,m=10,t,pG,gG,T,c=[3,5,2];
function create(){const s=this;s.add.rectangle(W/2,H/2,W,40,0x1b9bd7).setAlpha(.5);
T={pL:f(s,100,H/2-120,'p'),pR:f(s,100,H/2+120,'p'),eL:f(s,860,H/2-120,'e'),eR:f(s,860,H/2+120,'e')};
pG=s.physics.add.group();gG=s.physics.add.group();t=document.getElementById('elixir');r();
for(let i=1;i<=3;i++)document.getElementById('card-'+i).onclick=()=>a(s,i-1);
s.input.on('pointerdown',p=>{spawn(s,'p','r',200,p.y<H/2?Y[0]:Y[1])});
s.time.addEvent({delay:1e3,callback:d,callbackScope:s,loop:!0});
s.time.addEvent({delay:1e3,callback:()=>{e=Math.min(m,e+1);r()},loop:!0})}
function update(){[...pG.getChildren()].forEach(u=>o(this,u,gG,T,'p'));
[...gG.getChildren()].forEach(u=>o(this,u,pG,T,'e'))}
function f(s,x,y,S){const c=S==='p'?0x0cf59b:0xff6b6b,R=s.add.rectangle(x,y,64,80,c).setStrokeStyle(2,0);R.hp=200;
R.t=s.add.text(x,y-56,'200',{font:'16px Arial',color:'#fff'}).setOrigin(.5);return R}
function l(T){T.t.setText(Math.max(0,T.hp));if(T.hp<=0){T.setFillStyle(0x555);T.t.setText('Destroyed')}}
function spawn(s,S,d,x,y){const v={hp:30,speed:40,atk:8,range:14},c=S==='p'?0x4ec5ff:0xffbf69,q=s.add.circle(x,y,16,c);s.physics.add.existing(q);q.body.setSize(32,32);Object.assign(q,v,{S});
(S==='p'?pG:gG).add(q);q.t=s.add.text(x,y-26,q.hp,{font:'12px Arial',color:'#000'}).setOrigin(.5);return q}
function o(s,u,g,T,S){u.t.x=u.x;u.t.y=u.y-26;u.t.setText(Math.max(0,u.hp));if(u.hp<=0){u.t.destroy();u.destroy();return}
const E=g.getChildren().filter(e=>Math.abs(e.y-u.y)<24);if(E.length){E.sort((a,b)=>Math.abs(a.x-u.x)-Math.abs(b.x-u.x));
const n=E[0];if(Math.abs(n.x-u.x)>u.range){u.body.setVelocityX(u.speed*(n.x>u.x?1:-1))}else{u.body.setVelocityX(0);if(!u._l||s.time.now-u._l>500){n.hp-=u.atk;u._l=s.time.now}}return}
const y=S==='p'?(u.y<H/2?T.eR:T.eL):(u.y<H/2?T.pR:T.pL);if(Math.abs(y.y-u.y)<80){if(Math.abs(y.x-u.x)>u.range+10){u.body.setVelocityX(u.speed*(y.x>u.x?1:-1))}else{u.body.setVelocityX(0);if(!u._l||s.time.now-u._l>600){y.hp-=u.atk;l(y);u._l=s.time.now}}}
else{const tx=S==='p'?W-150:150;u.body.setVelocityX(u.speed*(tx>u.x?1:-1))}}
function a(s,i){const cost=c[i];if(e<cost){const el=document.getElementById('card-'+(i+1));el.classList.add('locked');setTimeout(()=>el.classList.remove('locked'),300);return}
e-=cost;r();if(i===0)spawn(s,'p','r',200,Y[0]);if(i===1)spawn(s,'p','r',200,Y[1]);if(i===2){const y=Math.random()>.5?Y[0]:Y[1];gG.getChildren().forEach(e=>{if(Math.abs(e.y-y)<24&&Math.abs(e.x-W/2)<300)e.hp-=15});const t=y===Y[0]?T.eR:T.eL;t.hp-=20;l(t)}}
function r(){t.innerText=e}function d(){this.aiPool=(this.aiPool||4)+1;this.aiPool=Math.min(10,this.aiPool);if(this.aiPool>=3&&Math.random()<.6){spawn(this,'e','l',W-200,Math.random()>.5?Y[0]:Y[1]);this.aiPool-=3}}
</script></body></html>
